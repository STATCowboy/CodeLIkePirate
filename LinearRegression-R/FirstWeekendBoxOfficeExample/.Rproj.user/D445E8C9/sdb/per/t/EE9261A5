{
    "collab_server" : "",
    "contents" : "#\n# Intro to R\n# by: Jamey Johnston\n# @STATCowboy\n# http://STATCowboy.com\n#\n# October 27, 2016\n#\n# Data from Texas A&M MS of Analytics - Dr. Simon Sheather\n# http://analytics.stat.tamu.edu/\n#\n\n# Cleanup objects in session\nrm(list=ls())\n\n# Turn off warnings\noptions(warn=-1)\n\n# Set the Working Directory (need to change to your directory)\nsetwd(\"C:/Users/Jamey/OneDrive/Documents/Statistics/R/Into-to-R-Session/LinearRegression-R/FirstWeekendBoxOfficeExample\")\n\n# Load packages - readxl to read Excel file, MASS for Regression tools, \nlibrary(readxl)\nlibrary(MASS)\n\n# Use readxl packages to read in Excel File\nfwerevbo <- read_excel(\"FirstWeekendBoxOffice.xlsx\", sheet=\"FirstWeekendBoxOffice\")\n\n# Convert to Factor (Categorical Variables)\nfwerevbo$Sequel <- as.factor(fwerevbo$Sequel)\nfwerevbo$MonthOfRelease <- as.factor(fwerevbo$MonthOfRelease)\n\n# Set an ID column from rownums (will be 1 ... X as we didn't name the rows)\n# We will not use later but useful for when you have to join data back together\nfwerevbo$id <- rownames(fwerevbo)\nView(fwerevbo)\n\n#\n# Split Data into Training/Validation (70%/30% split)\n# Set a seed so it splits the same everytime since this is a demo\nset.seed(20161028)\nind <- sample(2, nrow(fwerevbo), replace = TRUE, prob=c(0.7, 0.3))\n\nfwerevboTrain <- fwerevbo[ind == 1,]\nfwerevboValid <- fwerevbo[ind == 2,]\n\n# Summary Info and Basic Plots about Data\nhead(fwerevboTrain)\nsummary(fwerevboTrain)\nplot(sort(fwerevboTrain$FirstWeekendBoxOfficeRevenue))\nhist(fwerevboTrain$FirstWeekendBoxOfficeRevenue)\nplot(density(fwerevboTrain$FirstWeekendBoxOfficeRevenue))\nplot(FirstWeekendBoxOfficeRevenue~Views30, fwerevboTrain)\nboxplot(FirstWeekendBoxOfficeRevenue~Sequel, fwerevboTrain)\n\n# Use Log for FirstWeekendBoxOffice Dependent Variable \n# b/c of right skew of Revenue for model and run LM\n\nplot(sort(fwerevboTrain$Log_FirstWeekendBoxOfficeRevenue))\nhist(fwerevboTrain$Log_FirstWeekendBoxOfficeRevenue)\nplot(density(fwerevboTrain$Log_FirstWeekendBoxOfficeRevenue))\nplot(Log_FirstWeekendBoxOfficeRevenue~Views30, fwerevboTrain)\nboxplot(Log_FirstWeekendBoxOfficeRevenue~Sequel, fwerevboTrain)\n\n# Fit Liner Regression Model\nfwerevbo_log.lm <- lm(Log_FirstWeekendBoxOfficeRevenue ~ NumberOfTheaters+InceptionOfArticle+Views30+MonthOfRelease+Sequel, data=fwerevboTrain)\nsummary(fwerevbo_log.lm)\n\n#\n# LM with stepwise regression (both directions - forwards/backwards)\n#\n\nfwerevbo_log2.lm = step(fwerevbo_log.lm, direction=\"both\")\nsummary(fwerevbo_log2.lm)\nformula(fwerevbo_log2.lm)\n\n# Create Data Frame with of output including:\n#         studentized residuals (outliers) and Cook's D (leverage points)\nfwerevbo_log2.df <- data.frame(fwerevboTrain, fitted.value=exp(fitted(fwerevbo_log2.lm)), residual=resid(fwerevbo_log2.lm), studr=stdres(fwerevbo_log2.lm), cooksd=cooks.distance(fwerevbo_log2.lm))\n\n# Plot Studentized Residuals vs Cook's D to find Outliers and Leverage Points\nplot(studr~cooksd,fwerevbo_log2.df)\n\nanova(fwerevbo_log2.lm)\n\nplot(fwerevbo_log2.lm)\n\nfwerevboTrain[4,]\nfwerevboTrain[8,]\nfwerevboTrain[83,]\n\nView(fwerevbo_log2.df)\n\n#\n# Check Validation Data \n#\n\n# Save the model to a file to use for Prection of the Validation Data\nsave(fwerevbo_log2.lm, file=\"fwerevbo.RData\")\n\n# Now load the file to score (not we don't have to do this save/load to validate)\n# Just for demo person to show you how to save a model to use for scoring\n#\nload(\"fwerevbo.RData\")\n\npredictFWR <- predict(fwerevbo_log2.lm, newdata=fwerevboValid)\n\npredictedFWR <- cbind(fitted.value=exp(as.numeric(predictFWR)),fwerevboValid)\nView(predictedFWR)\n\n",
    "created" : 1429558181000.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4105535658",
    "id" : "EE9261A5",
    "lastKnownWriteTime" : 1477667024,
    "last_content_update" : 1477667024656,
    "path" : "C:/Users/Jamey/OneDrive/Documents/Statistics/R/Into-to-R-Session/LinearRegression-R/FirstWeekendBoxOfficeExample/FirstWeekendBoxOffice.R",
    "project_path" : "FirstWeekendBoxOffice.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}